#!/usr/bin/env node

const yaml = require('js-yaml');
const fs = require('fs');
const path = require('path');

module.exports = function (file) {

    if (fs.existsSync(file)) {

        return yaml.safeLoad(fs.readFileSync(file, 'utf8'));

    } else if ( fs.existsSync(path.join(__dirname, '../models/yamls/', path.basename(file))) )  {

        const model_path = path.join(__dirname, '../models/yamls/', path.basename(file));
        const model = yaml.safeLoad(fs.readFileSync(model_path, 'utf8'));

        const object = yaml.dump(model, {
            flowLevel: 3
        });

        fs.writeFileSync(file, String(object), { mode: 0o755 });

        return model;

    } else {

        return undefined;

    }

}